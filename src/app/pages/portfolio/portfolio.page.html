<ion-header [translucent]="true" class="ion-no-border">
  <ion-toolbar>
    <ion-buttons slot="start">
       <ion-button><ion-icon name="wallet-outline"></ion-icon></ion-button>
    </ion-buttons>
    <ion-title>ASSETS OVERVIEW</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="openSettings()">
        <ion-icon slot="icon-only" name="settings-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="cyber-bg">
    <div class="stars"></div>
    <div class="stars2"></div>
  </div>

  <div class="dashboard-card">
    
    <div class="balance-header">
      <span class="label">Total Balance (Est.)</span>
      <ion-icon [name]="hideBalance ? 'eye-off-outline' : 'eye-outline'" (click)="toggleVisibility()"></ion-icon>
    </div>

    <h1 class="main-balance" *ngIf="!hideBalance">
      <span *ngIf="!showInBTC">{{ totalBalanceUSD | currency:'USD':'symbol':'1.2-2' }}</span>
      <span *ngIf="showInBTC">â‰ˆ {{ (totalBalanceUSD / 95000) | number:'1.6-6' }} BTC</span> 
      
      <ion-icon name="swap-horizontal-outline" class="swap-icon" (click)="toggleCurrency()"></ion-icon>
    </h1>

    <h1 class="main-balance hidden-text" *ngIf="hideBalance">******</h1>

    <div class="pnl-badge" [class.profit]="totalPnL >= 0" [class.loss]="totalPnL < 0" *ngIf="!hideBalance">
      <span class="pnl-val">{{ totalPnL >= 0 ? '+' : '' }}{{ totalPnL | currency:'USD':'symbol':'1.2-2' }}</span>
      <span class="pnl-pct">({{ totalPnLPercent | number:'1.2-2' }}%)</span>
      <span class="time-label">All Time</span>
    </div>

    <div class="action-grid">
      <div class="action-btn">
        <div class="icon-circle filled"><ion-icon name="arrow-down-circle-outline"></ion-icon></div>
        <span>Deposit</span>
      </div>
      <div class="action-btn">
        <div class="icon-circle"><ion-icon name="arrow-up-circle-outline"></ion-icon></div>
        <span>Withdraw</span>
      </div>
      <div class="action-btn">
        <div class="icon-circle"><ion-icon name="swap-horizontal-outline"></ion-icon></div>
        <span>Transfer</span>
      </div>
    </div>
  </div>

  <div class="ion-text-center ion-padding" *ngIf="loading">
    <ion-spinner color="secondary"></ion-spinner>
    <p style="color: #666; margin-top: 10px;">Syncing Assets...</p>
  </div>

  <div *ngIf="!loading && myCoins.length === 0" class="empty-state">
    <ion-icon name="wallet-outline" size="large" color="medium"></ion-icon>
    <p>No assets holding yet.</p>
    <ion-button routerLink="/tabs/market" fill="outline" color="secondary">
      Go to Market
    </ion-button>
  </div>

  <ion-list lines="none" class="asset-list" *ngIf="myCoins.length > 0">
    <ion-list-header>
      <ion-label>Crypto Assets</ion-label>
    </ion-list-header>

    <ion-item-sliding *ngFor="let coin of myCoins" class="coin-item-sliding">
      <ion-item button [routerLink]="['/coin-detail', coin.id]" detail="false">
        <ion-avatar slot="start">
          <img [src]="coin.image" />
        </ion-avatar>
        
        <ion-label>
          <div class="row-top">
            <h2>{{ coin.symbol | uppercase }}</h2>
            <h2 class="price-value">{{ coin.totalValue | currency:'USD':'symbol':'1.2-2' }}</h2>
          </div>
          
          <div class="row-bottom">
            <p>{{ coin.amount }} coins</p>
            <p [class.text-green]="coin.pnl >= 0" [class.text-red]="coin.pnl < 0" *ngIf="coin.buyPrice > 0">
              {{ coin.pnl >= 0 ? '+' : '' }}{{ coin.pnlPercent | number:'1.2-2' }}%
            </p>
            <p style="color: #666" *ngIf="!coin.buyPrice || coin.buyPrice === 0">
              Set Buy Price
            </p>
          </div>
        </ion-label>
      </ion-item>

      <ion-item-options side="end">
        <ion-item-option class="cyber-delete-bg" (click)="remove(coin)">
          <ion-icon slot="icon-only" name="trash-outline"></ion-icon>
        </ion-item-option>
      </ion-item-options>
    </ion-item-sliding>
  </ion-list>
  
  <div style="height: 50px"></div>
</ion-content>